{% extends "base.html" %}
{% block title %}Список постов сайта{% endblock title %}
{% block content %}


<section class="py-5" style="background-color: #ded7d0">
    <div class="container mt-4">
        <h1 class="display-6 fw-bold mb-4">Наши проекты</h1>
    </div>
</section>
<section id="contact" class="py-5">
    <div class="container mt-4">
    {% for Project in Projects %}
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header bg-light py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h2 class="card-title h5 mb-0">
                        <a href="{% url 'mainpage:post_detail' Project.id %}" class="text-decoration-none text-dark fw-bold">
                            {{ Project.title }}
                        </a>
                    </h2>
                    <small class="text-muted">
                        <i class="far fa-calendar me-1"></i>
                        {{ Project.created_at|date:'d.m.Y H:i' }}
                    </small>
                </div>
            </div>
            
            <div class="card-body">
                <p class="card-text text-secondary mb-3">{{ Project.text }}</p>
                
                {% if Project.file.all %}
                    
                    <div id="carouselExampleIndicators{{Project.id}}" class="carousel slide" data-bs-ride="carousel">

                        <div class="carousel-indicators">
                            {% for file in Project.file.all%}   
                            
                                <button type="button" data-bs-target="#carouselExampleIndicators{{Project.id}}" data-bs-slide-to="{{ forloop.counter0 }}" aria-label="Slide {{forloop.counter0}}" class="{%if forloop.first%}active{% endif %}" aria-label="Slide {{ forloop.counter0 }}"></button>
                            {% endfor %}
                        </div>

                        <div class="carousel-inner">

                            {% for file in Project.file.all %}
                                <div class="carousel-item {%if forloop.first%}active{% endif %}" style="aspect-ratio: 16/9"> 
                                            <!-- Определяем тип файла для отображения -->
                                    {% with file_extension=file.file.url|lower|slice:'-4:' %}
                                        {% if file_extension == '.jpg' or file_extension == '.png' or file_extension == '.gif' or file.file.url|lower|slice:'-5:' == '.jpeg' %}
                                                <img src="{{ file.file.url }}" alt="{{ file.name }}" class="w-100 h-100 object-fit-cover object-position-center" >
                                        {% else %}
                                            <div class="text-center mb-2">
                                                <i class="far fa-file-alt fa-3x text-secondary"></i>
                                            </div>
                                        {% endif %}
                                    {% endwith %}


                                    <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: rgba(0,0,0,0.5);">
                                        <h6 class="card-title text-white text-truncate mb-0">{{ file.name }}</h6>
                                        {% if file.text %}
                                            <p class="card-text small text-light">{{ file.text|truncatewords:15 }}</p>
                                        {% endif %}
                                    </div>

                                </div>
                            {% endfor %}

                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators{{Project.id}}" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators{{Project.id}}" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                {% else %}
                    <div class="alert alert-info d-flex align-items-center" role="alert">
                        <i class="far fa-folder-open me-2"></i>
                        У этого проекта пока нет файлов
                    </div>
                {% endif %}
                
            </div>
        </div>
    {% empty %}
        <div class="text-center py-5">
            <i class="far fa-folder-open fa-3x text-secondary mb-3"></i>
            <h3 class="text-muted">Проектов еще нет</h3>
            <p class="text-muted">Здесь появятся проекты, когда они будут добавлены</p>
        </div>
    {% endfor %}
    </div>
</section>


<!-- Подключение Font Awesome для иконок -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">


{% endblock content %} 
